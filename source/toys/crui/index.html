<!DOCTYPE html>

<head>
  <meta name="viewport" content="width=device-width" />
  <link rel="icon" href="data:" />
  <title>crui demo</title>
</head>

<style></style>

<body></body>

<script>
  /**
   * ===== Design Goals =====
   * 基于约定
   * 传递原生 DOM 对象
   * 样式隔离
   * 高度压缩，尽量避免使用属性等难以压缩的语法
   * 提供示例组件库（crui，模仿 Chrome 设置页面的 UI 库）
   */
</script>

<script>
  // const ValueHook = (v) => [ValueHook, v];
  // const Style = (v) => [Style, v];
  // const C = (f) => {
  //   return (...args) => {
  //     f(args);
  //   };
  // };
  // with ({ a: 1 }) {
  //   console.log(a);
  // }
  const BlinkTextContent = (v) => [BlinkTextContent, v];
  const BlinkText = (...args) => {
    return [BlinkText, dom];
  };

  const StyleBackground = (v) => [StyleBackground, v];
  // const domApplier = {};
  // domApplier[StyleBackground] = (dom, v) => (dom.style.background = v);
  // Object.freeze(domApplier);
  const ClockInterval = (v) => [ClockInterval, v];
  const ident = () => {};
  const Clock = (...args) => {
    const dom = document.createElement("span");
    const AppendChild = (_, v) => dom.appendChild(v);
    // <span>
    //   20220902 21:09
    //   <b>this is a Blink Text</b>
    // </span>;
    let interval = 1000;
    const applier = {};
    // applier.prototype = defaultApplier;
    // applier[ClockInterval] = (_, v) => (interval = v);
    applier[AppendChild] = AppendChild;
    for (const [applier, v] of args) applier(dom, v);
    // switch (type) {
    //   case ClockInterval:
    //     interval = inner;
    //     break;
    //   case ValueHook:
    //     inner.v = setValue;
    //     break;
    //   default:
    //     commonArgProc(type, inner);
    //     break;
    // }

    const tick = () => {
      dom.textContent = new Date();
      setTimeout(tick, interval);
    };
    tick();
    return [Clock, dom];
  };

  const Root = (...args) => {
    const dom = document.createElement("div");
    const hook = {};
    const inner = Clock(
      {},
      ClockInterval(200),
      // ValueHook(hook),

      StyleBackground("#fff"),
      // StyleMarginTop("20px"),
      OnClick(() => {})
      // BlinkText(BlinkTextContent("this is a blink text"))
    );
    return [Root, inner[1]];
  };

  document.body.appendChild(Root()[1]);

  // function Counter(props) {
  //   const [value, setValue] = useState(0);
  //   return Card(
  //     Text(value),
  //     Button(
  //       Text("Add one"),
  //       OnClick((event, button) => {
  //         setValue(value + 1);
  //       })
  //     )
  //   );
  // }

  // Card(
  //   Button(Text("Text content")),
  //   Text("Text content"),
  //   OnClick((event, card) => {
  //     console.log("on click");
  //   }),
  //   Grid(
  //     Button(Text("Text content")),
  //     Button(
  //       Text("Text content"),
  //       OnClick((event, button) => {
  //         console.log("on click");
  //       })
  //     )
  //   )
  // );
</script>
